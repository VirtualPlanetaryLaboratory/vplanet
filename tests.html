<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Writing Tests and Examples &mdash; VPLanet 2.5.6
 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=d948c9a6" />
      <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=53b7011b"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Attribution" href="attr.html" />
    <link rel="prev" title="VPLanet Contributors Guide" href="StyleGuide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            VPLanet
          </a>
              <div class="version">
                2.5.6

              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing VPLanet</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Options and Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="src.html">C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="vplot.html">VPLOT</a></li>
<li class="toctree-l1"><a class="reference internal" href="parametersweep.html">Parameter Sweep Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="http://faculty.washington.edu/rkb9/vplanet/Workshop21/">Workshop Lectures</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="developers.html">Contributor’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="StyleGuide.html">Style Guide</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Writing Tests and Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unit-tests">Unit Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writing-examples">Writing Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="attr.html">Attribution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="repos.html">Other VPLanet Repositories</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/VirtualPlanetaryLaboratory/vplanet">GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">VPLanet</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="developers.html">Contributor’s Guide</a></li>
      <li class="breadcrumb-item active">Writing Tests and Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tests.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="writing-tests-and-examples">
<h1>Writing Tests and Examples<a class="headerlink" href="#writing-tests-and-examples" title="Link to this heading"></a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#unit-tests" id="id3">Unit Tests</a></p></li>
<li><p><a class="reference internal" href="#writing-examples" id="id4">Writing Examples</a></p></li>
</ul>
</nav>
<section id="unit-tests">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Unit Tests</a><a class="headerlink" href="#unit-tests" title="Link to this heading"></a></h2>
<p>VPLanet includes “unit tests” to maintain code results as the project grows.
These tests are short versions of the examples that run in a few seconds, which
is sufficient time to ensure that integration is accurate. Unit tests are also
used to track the amount of the code that is executed over the sum of all tests,
further enabling confidence in the code’s accuracy.</p>
<p>Test scripts live in the <code class="code docutils literal notranslate"><span class="pre">tests/</span></code> directory and are executed automatically
on every pull request with GitHub Actions. To perform the tests, we use <code class="code docutils literal notranslate"><span class="pre">pytest</span></code>, which will
find all Python files with the word <code class="code docutils literal notranslate"><span class="pre">test</span></code> somewhere in their name (side note:
if it’s not meant to be a test, don’t put <code class="code docutils literal notranslate"><span class="pre">test</span></code> in the file name!). Under the <code class="code docutils literal notranslate"><span class="pre">tests</span></code>
directory are subdirectories whose names consists of VPLanet modules, e.g. BINARY and AtmescEqtideStellar.
These subdirectories contain the tests available for the module combinations of the subdirectory name.</p>
<p>The VPLanet team has made it easy to add or revise tests. Inside the <code class="code docutils literal notranslate"><span class="pre">tests/</span></code> directory
is a file called <code class="code docutils literal notranslate"><span class="pre">maketest.py</span></code>, which will generate a unit test from a set of valid infiles.
So a typical procedure to create a new test is to:</p>
<ul class="simple">
<li><p>Create a simulation that executes previously untested functionality</p></li>
<li><p>Verify the results are accurate! (Obvious, we know, but please don’t forget!)</p></li>
<li><p>Create a subdirectory with a unique name for your test.</p></li>
<li><p>Copy the .in files for your test into your new subdirectory</p></li>
<li><p>cd to the <code class="code docutils literal notranslate"><span class="pre">tests</span></code> directory and run <code class="docutils literal notranslate"><span class="pre">`python</span> <span class="pre">maketest.py</span> <span class="pre">&lt;modules/subdir&gt;`</span></code>, which the
argument is the relative to path to your new test</p></li>
<li><p>Commit your .in files and the new :code:<a href="#id1"><span class="problematic" id="id2">`</span></a>test_&lt;subdir&gt;.py” file to the repository</p></li>
<li><p>Issue a PR!</p></li>
</ul>
<p>These unit tests not only ensure new modification don’t break parts of the code
that already work. In addition, they are used to compute the fraction of the code
that is verified with <cite>CodeCov &lt;https://app.codecov.io/gh/VirtualPlanetaryLaboratory/vplanet&gt;</cite>
Thus, to approach (and someday maintain) 100% verification requires all new
features to include a unit test. Finally, unit tests are valuable for ensuring
that no memory issues are present through periodic valgrind tests.</p>
</section>
<section id="writing-examples">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Writing Examples</a><a class="headerlink" href="#writing-examples" title="Link to this heading"></a></h2>
<p>Examples live in the <code class="code docutils literal notranslate"><span class="pre">examples/</span></code> directory in the top-level repo folder, and,
just like tests, there should be one aptly-named folder per example. Include
the input files needed to run the example and a <code class="code docutils literal notranslate"><span class="pre">README.rst</span></code> file that
describes the example and its expected output in detail:</p>
<div class="highlight-rest notranslate"><div class="highlight"><pre><span></span><span class="gh">Example name</span>
<span class="gh">============</span>

<span class="gh">Overview</span>
<span class="gh">--------</span>

===================   ============
<span class="gs">**Date**</span>              MM/DD/YY
<span class="gs">**Author**</span>            AUTHOR_NAME
<span class="gs">**Modules**</span>           <span class="s">`MODULE1_NAME </span><span class="si">&lt;../src/MODULE1_NAME.html&gt;</span><span class="s">`_</span>
                      <span class="s">`MODULE2_NAME </span><span class="si">&lt;../src/MODULE2_NAME.html&gt;</span><span class="s">`_</span>
<span class="gs">**Approx. runtime**</span>   RUNTIME_IN_SECONDS
<span class="gs">**Source code**</span>       <span class="s">`GitHub </span><span class="si">&lt;https://github.com/VirtualPlanetaryLaboratory/vplanet-private/tree/master/examples/EXAMPLE_DIR_NAME&gt;</span><span class="s">`_</span>
===================   ============

DETAILED DESCRIPTION OF THE EXAMPLE

<span class="gh">To run this example</span>
<span class="gh">-------------------</span>

EXACT INSTRUCTIONS TO REPRODUCE EXAMPLE

<span class="p">..</span> <span class="ow">code-block</span><span class="p">::</span> <span class="k">bash</span>

    python<span class="w"> </span>makeplot.py


<span class="gh">Expected output</span>
<span class="gh">---------------</span>

FIGURES SHOWCASING THE EXAMPLE OUTPUT

<span class="p">..</span> <span class="ow">figure</span><span class="p">::</span> UNIQUE_FIGURE_NAME.png
   <span class="nc">:width:</span> 600px
   <span class="nc">:align:</span> center

   FIGURE CAPTION
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">note<span class="colon">:</span></dt>
<dd class="field-odd"><p>All example figures are generated by the same command: python makplot.py.</p>
</dd>
</dl>
<p>When creating an example, run it to figure out the approximate
runtime (see above) and create <strong>low resolution PNG images</strong> (no more
than about 800x800 pixels) with <strong>unique file names</strong> (so they don’t
overwrite images from other examples when building the docs) in the
example directory. To commit these images, you’ll need to <strong>force add them</strong>
since <code class="code docutils literal notranslate"><span class="pre">png</span></code> files are in the <cite>.gitignore</cite> by default:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>-f<span class="w"> </span>UNIQUE_FIGURE_NAME.png
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="StyleGuide.html" class="btn btn-neutral float-left" title="VPLanet Contributors Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="attr.html" class="btn btn-neutral float-right" title="Attribution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2024, The VPLanet Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>